"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.restoreDex = void 0;
const fs_extra_1 = require("fs-extra");
const path_1 = require("path");
function dexName() {
    return 'classes.dex';
}
function restoreDex(pluginRelativeDir, cacheDir, outputDir, is_uni_modules) {
    const cacheFile = resolveDexCacheFile(pluginRelativeDir, cacheDir);
    if (cacheFile) {
        let filename = (0, path_1.join)(outputDir, pluginRelativeDir, is_uni_modules ? 'utssdk' : '', 'app-android', dexName());
        (0, fs_extra_1.copySync)(cacheFile, filename);
        return filename;
    }
}
exports.restoreDex = restoreDex;
function resolveDexCacheFilename(pluginRelativeDir, cacheDir) {
    return (0, path_1.join)(cacheDir, 'app-android', 'uts', pluginRelativeDir, dexName());
}
function resolveDexCacheFile(pluginRelativeDir, cacheDir) {
    if (cacheDir) {
        const file = resolveDexCacheFilename(pluginRelativeDir, cacheDir);
        return ((0, fs_extra_1.existsSync)(file) && file) || '';
    }
    return '';
}
