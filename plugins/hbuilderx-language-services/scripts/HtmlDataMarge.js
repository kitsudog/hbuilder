const fs=require("fs-extra"),path=require("path"),colorLog=require("./ColorLog.js");let _dataPathList=[];function traverseFolder(t){const e=[];return function t(r){fs.readdirSync(r).forEach((a=>{const o=path.join(r,a),s=fs.statSync(o);s.isFile()?e.push(o):s.isDirectory()&&t(o)}))}(t),e}function initList(){const t=path.join(__dirname,"../htmlservice/server/data/uni_vue_tag"),e=path.resolve(t);_dataPathList=traverseFolder(e)}function createMargeData(){colorLog.warnLog("CreateMargeData","Marge Start!"),initList();const t={globalAttributes:[],tags:[]};_dataPathList.forEach((e=>{if(e.includes("tags.json"))return;if(!e.endsWith(".json"))return;const r=fs.readFileSync(e,"utf-8");let a;try{a=JSON.parse(r)}catch(t){colorLog.errorLog("BuildMergeTags",`Error: ${t}! File: ${e}`),process.exit(-1)}a&&(e.includes("globalAttributes.json")?t.globalAttributes.push(...a):t.tags.push(a))}));const e=path.join(__dirname,"../htmlservice/server/data/uni_vue_tag.json");fs.writeFileSync(e,JSON.stringify(t,null,4),{encoding:"utf8",flag:"w"}),colorLog.warnLog("CreateMargeData","Marge End!")}module.exports={createMargeData:createMargeData};