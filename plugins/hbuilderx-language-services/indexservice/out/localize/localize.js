"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.loadMessageBundle=void 0;const fs=require("fs"),path=require("path"),nls=require("vscode-nls"),core_1=require("../../../core"),rootExtensionPath=(0,core_1.getExtensionRootPath)(),extensionPath=path.dirname(__dirname),sourcePath=path.dirname(__filename);class HxI18n{constructor(){if(this._language="zh_CN",this._localizeMap=new Map,process.env.VSCODE_NLS_CONFIG){let e=(0,core_1.tryCatchJSONParse)(process.env.VSCODE_NLS_CONFIG);if("string"!=typeof e.locale)return;const t=e.locale;this._language=t}}getLocalize(e){return(t,s,...n)=>{const a=this._localizeMap.get(e),o=(null==a?void 0:a[t])||s;return nls.loadMessageBundle()(t,o,...n)}}getI18nFile(e,t){const s=e.slice(0,e.lastIndexOf(path.extname(e))),n=path.relative(extensionPath,s);return path.join(rootExtensionPath,"indexservice/i18n",this._language,`${n}.i18n.json`)}loadMessageBundle(e,t){const s=nls.loadMessageBundle(),n=this.getI18nFile(e,t);if(!this._localizeMap.has(n)){const e=(0,core_1.noTsToNormalizedPath)(n);if(!e)return s;if(!fs.existsSync(e))return s;const t=require(e);this._localizeMap.set(n,t)}return this.getLocalize(n)}}const hxI18n=new HxI18n;function loadMessageBundle(e,t){return hxI18n.loadMessageBundle(e,t)}exports.loadMessageBundle=loadMessageBundle;