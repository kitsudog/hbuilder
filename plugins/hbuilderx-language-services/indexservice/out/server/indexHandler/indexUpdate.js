"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.IndexUpdate=void 0;class IndexUpdate{static instance(){return void 0===this._instance&&(this._instance=new IndexUpdate),this._instance}ReacquireData(e,t){if(e)return;e||(e=!0);const a=t.projectHandler;a.fileVersion.cleanGFileVersionCache(),a.fileTask.setUpdate(!0)}doUpdate(e){const t=e.indexProjectData.canonicalVersion,a=t.substring(t.length-8);this.compatibleData(e,a),this.targetUpdate(!1,e,a),e.projectHandler.fileData.setForceSaveFlag(!0)}compatibleData(e,t){if(t>="20231218")return;const a=e.indexProjectData;["CLASS","ID"].forEach((e=>{const t=a.kindMap.get(e);if(!t)return;let n=".";"ID"===e&&(n="#");for(const e of t.keys()){const a=t.get(e);if(a)for(const e of a.indexValues)e.value.startsWith(n)&&(e.value=e.value.substring(1))}}))}targetUpdate(e,t,a){}}exports.IndexUpdate=IndexUpdate;