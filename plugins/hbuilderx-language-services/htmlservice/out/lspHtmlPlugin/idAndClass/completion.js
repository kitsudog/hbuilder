"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.IdClassCompletion=void 0;const core_1=require("../../../../core"),specialStringPlugin_1=require("../../../../specialStringPlugin"),plugins_1=require("../../plugins");class IdClassCompletion{constructor(t,e){this._htmlLanguageServer=t,this._allInfo=e}get project(){return this._allInfo.project}async doExtraCompletion(t,e,i,n){let s=this._htmlLanguageServer.getLocationInfoAtPosition(e,i,n);if(!s)return t;if(!s.activeAttribute)return t;if(s.kind===plugins_1.LocationInfoKind.AttributeValue)t=await this.addCssIdCompletion(t,e,i,s),t=await this.addCssClassCompletion(t,e,i,s);return t}async addCssIdCompletion(t,e,i,n){if("id"!==n.activeAttribute)return t;const s=e.offsetAt(i),r={range:(0,core_1.getContextData)(e,s,void 0).contextRange,kind:specialStringPlugin_1.StringLocationInfoKind.IN_HTML_LIKE,ast:void 0,project:this.project};let o=new Map;const a=specialStringPlugin_1.StringServicesContainer.create(o),l=await(0,specialStringPlugin_1.specialStringDoCompleteAsync)(["HBuilderX.IDString"],e,i,r,a,[]);return t.items.push(...l.items),t}async addCssClassCompletion(t,e,i,n){if("class"!==n.activeAttribute)return t;const s=e.offsetAt(i),r={range:(0,core_1.getContextData)(e,s,void 0).contextRange,kind:specialStringPlugin_1.StringLocationInfoKind.IN_HTML_LIKE,ast:void 0,project:this.project};let o=new Map;const a=specialStringPlugin_1.StringServicesContainer.create(o),l=await(0,specialStringPlugin_1.specialStringDoCompleteAsync)(["HBuilderX.ClassString"],e,i,r,a,[]);return t.items.push(...l.items),t}}exports.IdClassCompletion=IdClassCompletion;