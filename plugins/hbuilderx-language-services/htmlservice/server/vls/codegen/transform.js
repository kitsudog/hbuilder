"use strict";var __values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};function colletVars(e,t,r){var n,i,o,l;if(e.isIdentifier(t))r.push(t.text);else if(e.isObjectBindingPattern(t))try{for(var a=__values(t.elements),s=a.next();!s.done;s=a.next()){var f=s.value;colletVars(e,f.name,r)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}else if(e.isArrayBindingPattern(t))try{for(var d=__values(t.elements),u=d.next();!u.done;u=d.next()){f=u.value;e.isBindingElement(f)&&colletVars(e,f.name,r)}}catch(e){o={error:e}}finally{try{u&&!u.done&&(l=d.return)&&l.call(d)}finally{if(o)throw o.error}}else t.forEachChild((function(t){return colletVars(e,t,r)}))}function writeInterpolation(e,t,r,n,i,o,l){walkInterpolationFragment(ts,r+e+n,(function(n,o,l){if(console.log(n,o,l),void 0===o)i.addText(n);else{var a="",s=(o-=r.length)+n.length-e.length;s>0&&(a=n.substring(n.length-s),n=n.substring(0,n.length-s)),o<0&&(i.addText(n.substring(0,-o)),n=n.substring(-o),o=0),void 0!==t?i.addCode2(n,t+o,void 0):i.addText(n),i.addText(a)}}),o,l)}function walkInterpolationFragment(e,t,r,n,i){var o=makeMap(GLOBALS_WHITE_LISTED),l=[],a=e.createSourceFile("/foo.ts",t,e.ScriptTarget.ESNext),s=function(e,t){var r=!!n[e.text]||o(e.text)||"require"===e.text||e.text.startsWith("__VLS_");console.log(r),r||(l.push({text:e.text,isShorthand:t,offset:e.getStart(a)}),i.add(e.text))};if(a.forEachChild((function(t){return walkIdentifiers(e,t,s,n)})),(l=l.sort((function(e,t){return e.offset-t.offset}))).length){l[0].isShorthand?(r(t.substring(0,l[0].offset+l[0].text.length),0),r(": ",void 0)):r(t.substring(0,l[0].offset),0);for(var f=0;f<l.length-1;f++)r("",l[f+1].offset,!0),r("__VLS_ctx.",void 0),l[f+1].isShorthand?(r(t.substring(l[f].offset,l[f+1].offset+l[f+1].text.length),l[f].offset),r(": ",void 0)):r(t.substring(l[f].offset,l[f+1].offset),l[f].offset);r("",l[l.length-1].offset,!0),r("__VLS_ctx.",void 0),r(t.substring(l[l.length-1].offset),l[l.length-1].offset)}else r(t,0)}function walkIdentifiers(e,t,r,n){var i,o,l,a,s,f,d,u,c,h,v,x,y,p,g=[];if(e.isIdentifier(t))r(t,!1);else if(e.isShorthandPropertyAssignment(t))r(t.name,!0);else if(e.isPropertyAccessExpression(t))walkIdentifiers(e,t.expression,r,n);else if(e.isVariableDeclaration(t)){colletVars(e,t.name,g);try{for(var w=__values(g),_=w.next();!_.done;_=w.next()){var m=_.value;n[m]=(null!==(y=n[m])&&void 0!==y?y:0)+1}}catch(e){i={error:e}}finally{try{_&&!_.done&&(o=w.return)&&o.call(w)}finally{if(i)throw i.error}}t.initializer&&walkIdentifiers(e,t.initializer,r,n)}else if(e.isArrowFunction(t)){var I=[];try{for(var k=__values(t.parameters),b=k.next();!b.done;b=k.next()){var S=b.value;colletVars(e,S.name,I),S.type&&walkIdentifiers(e,S.type,r,n)}}catch(e){l={error:e}}finally{try{b&&!b.done&&(a=k.return)&&a.call(k)}finally{if(l)throw l.error}}try{for(var V=__values(I),E=V.next();!E.done;E=V.next()){m=E.value;n[m]=(null!==(p=n[m])&&void 0!==p?p:0)+1}}catch(e){s={error:e}}finally{try{E&&!E.done&&(f=V.return)&&f.call(V)}finally{if(s)throw s.error}}walkIdentifiers(e,t.body,r,n);try{for(var A=__values(I),T=A.next();!T.done;T=A.next()){m=T.value;n[m]--}}catch(e){d={error:e}}finally{try{T&&!T.done&&(u=A.return)&&u.call(A)}finally{if(d)throw d.error}}}else if(e.isObjectLiteralExpression(t))try{for(var F=__values(t.properties),L=F.next();!L.done;L=F.next()){var P=L.value;e.isPropertyAssignment(P)?(e.isComputedPropertyName(P.name)&&walkIdentifiers(e,P.name.expression,r,n),walkIdentifiers(e,P.initializer,r,n)):e.isShorthandPropertyAssignment(P)?walkIdentifiers(e,P,r,n):e.isSpreadAssignment(P)&&walkIdentifiers(e,P.expression,r,n)}}catch(e){c={error:e}}finally{try{L&&!L.done&&(h=F.return)&&h.call(F)}finally{if(c)throw c.error}}else t.forEachChild((function(t){return walkIdentifiers(e,t,r,n)}));try{for(var C=__values(g),O=C.next();!O.done;O=C.next()){m=O.value;n[m]--}}catch(e){v={error:e}}finally{try{O&&!O.done&&(x=C.return)&&x.call(C)}finally{if(v)throw v.error}}}function makeMap(e){for(var t=Object.create(null),r=e.split(","),n=0;n<r.length;n++)t[r[n]]=!0;return function(e){return!!t[e]}}exports.__esModule=!0,exports.walkIdentifiers=exports.walkInterpolationFragment=exports.writeInterpolation=exports.colletVars=void 0,exports.colletVars=colletVars,exports.writeInterpolation=writeInterpolation,exports.walkInterpolationFragment=walkInterpolationFragment,exports.walkIdentifiers=walkIdentifiers;