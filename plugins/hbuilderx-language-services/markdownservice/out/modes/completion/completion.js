"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Completion=void 0;const vscode_languageserver_protocol_1=require("vscode-languageserver-protocol"),core_1=require("../../../../core"),codeBlockType_1=require("./codeBlockType");class Completion{doExtraComplete(e,t,o){o.items.forEach((e=>{this.splitAliasTitle(e)}));const r=this.getCodeBlockLang(e,t);return o.items.push(...r),o}getCodeBlockLang(e,t){const o=[],r=e.offsetAt(t),i=(0,core_1.getLineTextFromPosition)(e,t),s=(0,core_1.getContextData)(e,r,' \t\n\r":{[()]},*>+`');return i.trim().startsWith("```")?(codeBlockType_1.CodeBlockLangList.forEach((e=>{o.push({label:e,textEdit:vscode_languageserver_protocol_1.TextEdit.replace(s.contextRange,e),kind:vscode_languageserver_protocol_1.CompletionItemKind.Property,data:{hxKind:core_1.HxIconKind.ATTRIBUTE}})})),o):o}splitAliasTitle(e){const t=e.label.trim();if(!t.startsWith("#"))return;if(t.includes(" "))return;if(!t.includes("@"))return;if(e.label=t.split("@")[0],!e.textEdit)return;const o=e.textEdit.newText;return e.textEdit.newText=o.split("@")[0],e}}exports.Completion=Completion;