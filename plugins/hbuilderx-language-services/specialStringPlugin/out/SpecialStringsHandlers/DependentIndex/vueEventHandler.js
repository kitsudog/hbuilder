"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const vscode_languageserver_protocol_1=require("vscode-languageserver-protocol"),vscode_uri_1=require("vscode-uri"),core_1=require("../../../../core"),handlerType_1=require("../handlerType"),indexBaseHandler_1=require("./indexBaseHandler");function getExportNameValue(e,r){let t=e.statements.find(r.isExportAssignment);if(t){let e=t.getChildren().find(r.isObjectLiteralExpression);if(e){let t=e.properties.find((e=>e.kind==r.SyntaxKind.PropertyAssignment&&/['\"]?name['\"]?/.test(e.name.getText())));if(t){let e=t.initializer;if(r.isStringLiteral(e)){let r=e.getText(),t=r[0];"'"!=t&&'"'!=t||(r=r.slice(0));let n=r[r.length-1];return"'"!=n&&'"'!=n||(r=r.slice(0,-1)),r}}}}return""}class VueEventHandler extends indexBaseHandler_1.IndexBaseHandler{async doCompleteAsync(e,r,t,n,i){let o=[],s=getExportNameValue(t.ast,n.get(handlerType_1.LanguageServiceType.TS));if(s){const e=/[A-Z]/;let r=s.search(e),n="";for(;r>=0;)n+=s.slice(0,r),n+="-"+s[r].toLocaleLowerCase(),s=s.slice(r+1),r=s.search(e);n+=s;vscode_uri_1.URI.file(t.project.fsPath).toString();const i=(0,core_1.onDiskQuery)([]);if(!i)return o;i.forEach(((e,r)=>{var t;let i=e["vue-components"];if(i instanceof Array)for(let e=0;e<i.length;e++){const r=i[e];if(r.label==n){const e=null===(t=null==r?void 0:r.data)||void 0===t?void 0:t.events;e instanceof Array&&e.forEach((e=>{"string"==typeof e&&o.push({label:e,kind:vscode_languageserver_protocol_1.CompletionItemKind.Property})}));break}}}))}return o}}exports.default=VueEventHandler;