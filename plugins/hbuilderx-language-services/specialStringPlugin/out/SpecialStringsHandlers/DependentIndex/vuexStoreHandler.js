"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const core_1=require("../../../../core"),utils_1=require("../utils"),indexBaseHandler_1=require("./indexBaseHandler");class VuexStoreHandler extends indexBaseHandler_1.IndexBaseHandler{constructor(e){super(),this._method=e,"commit"===this._method?this._type="mutations":"dispatch"===this._method&&(this._type="actions")}async doCompleteAsync(e,t,n,o,i){const r=(0,core_1.noTsToNormalizedUri)(n.project.fsPath);if(!r)return i;const a=[{projectUri:r,kind:"VUEX",limit:1e3}];let s;if(s=await n.project.indexPipeHandler.getIndexDataRequest(a,!1),!s)return i;if(0===s.length)return i;s.forEach((e=>{e=(0,utils_1.specialNormalizationIndexData)(n.kind,e)}));const c={options:{text:this._type,kind:core_1.IndexItemType.DEF,needRange:!0},filter:function(e,t){let n=!1,o=!1,i=!1;void 0!==t.options.text&&t.options.text===e.context&&(n=!0),void 0!==t.options.kind&&t.options.kind===e.kind&&(o=!0),t.options.needRange&&e.range&&(i=!0);return!(o&&i&&n)}},d=[];s.forEach((e=>{const t=(0,core_1.lspFilterIndexData)(e,c);d.push(t)}));const l={replaceRange:n.range,needFilePath:!0},p=[];return d.forEach((e=>{p.push(...(0,core_1.creatorCompletionFromIndexData)(e,l))})),p}async doDefinitionAsync(e,t,n,o,i){const r=(0,core_1.noTsToNormalizedUri)(n.project.fsPath);if(!r)return i;const a=[{projectUri:r,kind:"VUEX"}];let s;if(s=await n.project.indexPipeHandler.getIndexDataRequest(a,!1),!s)return i;if(0===s.length)return i;s.forEach((e=>{e=(0,utils_1.specialNormalizationIndexData)(n.kind,e)}));const c={options:{text:e.getText(n.range),kind:core_1.IndexItemType.DEF,needRange:!0},filter:function(e,t){let n=!1,o=!1,i=!1;void 0!==t.options.kind&&t.options.kind===e.kind&&(n=!0),void 0!==t.options.text&&t.options.text===e.value&&(o=!0),t.options.needRange&&e.range&&(i=!0);return!(n&&o&&i)}},d=[];s.forEach((e=>{const t=(0,core_1.lspFilterIndexData)(e,c);d.push(t)}));const l=[];d.forEach((e=>{const t=(0,core_1.creatorExtLocationLinksFromIndexData)(e,n.range);l.unshift(...t)}));const p=(0,core_1.extLocationToOld)(l);return i.unshift(...p),i}}exports.default=VuexStoreHandler;