"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const path=require("path"),vscode_languageserver_protocol_1=require("vscode-languageserver-protocol"),core_1=require("../../../../core"),handlerType_1=require("../handlerType"),BaseHandler_1=require("./BaseHandler");class VueEventHandler extends BaseHandler_1.BaseHandler{async doCompleteAsync(e,t,r,a,l){let o=[],n=r.ast,i=a.get(handlerType_1.LanguageServiceType.TYPESCRIPT_LANGUAGE_SERVICE).getProgram();if(!i)return o;let s=path.basename(n.fileName);s=s.split(".")[0];let p=path.join(path.dirname(n.fileName),s+".vue.__VLS_template.tsx"),d=i.getSourceFile(p);if(!d&&(p=path.join(path.dirname(n.fileName),s+".vue.__VLS_template.jsx"),d=i.getSourceFile(p),!d))return o;let u=i.getTypeChecker();if(!u)return o;let c=u.getSymbolsInScope(d,core_1.ts.SymbolFlags.Alias).find((e=>"___VLS_options"===e.escapedName));if(c){let e=u.getTypeOfSymbolAtLocation(c,d);if(e){let t=u.getPropertiesOfType(e).find((e=>"data"===e.escapedName));if(t){let e=u.getTypeOfSymbolAtLocation(t,d);if(e){let t=u.getReturnTypeOfSignature(e.getCallSignatures()[0]);if(t){u.getPropertiesOfType(t).forEach((e=>{o.push({label:e.escapedName,kind:vscode_languageserver_protocol_1.CompletionItemKind.Property})}))}}}}}return o}}exports.default=VueEventHandler;