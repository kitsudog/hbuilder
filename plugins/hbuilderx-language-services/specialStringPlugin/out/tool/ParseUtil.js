"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ParseUtil=void 0;const core_1=require("../../../core");var ParseUtil;!function(t){function e(t){const e=function(t){switch(t.kind){case core_1.ts.SyntaxKind.StringLiteral:case core_1.ts.SyntaxKind.NoSubstitutionTemplateLiteral:case core_1.ts.SyntaxKind.NumericLiteral:if(t.parent.kind===core_1.ts.SyntaxKind.ComputedPropertyName)return core_1.ts.isObjectLiteralElement(t.parent.parent)?t.parent.parent:void 0;case core_1.ts.SyntaxKind.Identifier:return!core_1.ts.isObjectLiteralElement(t.parent)||t.parent.parent.kind!==core_1.ts.SyntaxKind.ObjectLiteralExpression&&t.parent.parent.kind!==core_1.ts.SyntaxKind.JsxAttributes||t.parent.name!==t?void 0:t.parent}return}(t);return e&&(core_1.ts.isObjectLiteralExpression(e.parent)||core_1.ts.isJsxAttributes(e.parent))?e:void 0}function n(t){return t.kind===core_1.ts.SyntaxKind.ComputedPropertyName?core_1.ts.isStringLiteralLike(t.expression)||core_1.ts.isNumericLiteral(t.expression)?t.expression.text:void 0:core_1.ts.isPrivateIdentifier(t)?core_1.ts.idText(t):(e=t,core_1.ts.isMemberName(e)?core_1.ts.idText(e):e.getText());var e}function i(t,i){if(!t||!t.parent)return[];var r=e(t);if(r){const t=n(r.name);if(!t)return[];var s=i.getContextualType(r.parent);if(s){var o=s.getProperty(t);if(o)return[o]}}var a=i.getSymbolAtLocation(t);return a?[a]:[]}function r(t){if(t.kind===core_1.ts.SyntaxKind.SourceFile){let e=t.statements;for(let t=0;t<(null==e?void 0:e.length);++t){let n=e[t];if((null==n?void 0:n.kind)===core_1.ts.SyntaxKind.ExportAssignment){let t=n.expression;for(let e=0;e<t.getChildCount();++e){let n=t.getChildAt(e);if(n.kind===core_1.ts.SyntaxKind.SyntaxList)return n}}}}return null}function s(t){let e={mapActions:null,mapMutations:null},n=function(t){let e=r(t);if(e)for(let t=0;t<e.getChildCount();++t){let n=e.getChildAt(t);if(n.kind===core_1.ts.SyntaxKind.PropertyAssignment){let t=n;if("methods"===t.name.getText()&&(null==t?void 0:t.initializer.kind)===core_1.ts.SyntaxKind.ObjectLiteralExpression)return t.initializer}}return null}(t);if(n&&n.kind===core_1.ts.SyntaxKind.ObjectLiteralExpression){let t=n;for(let n=0;n<t.properties.length;++n){let i=t.properties[n];if(i.kind===core_1.ts.SyntaxKind.SpreadAssignment){let t=i.expression;if(t.kind===core_1.ts.SyntaxKind.CallExpression&&(null==t?void 0:t.expression.kind)===core_1.ts.SyntaxKind.Identifier){let n=null==t?void 0:t.expression;"mapActions"===n.escapedText?e.mapActions=t.arguments[0]:"mapMutations"===n.escapedText&&(e.mapMutations=t.arguments[0])}}}}return e}function o(t){let e=[],n=r(t);if(n)for(let t=0;t<n.getChildCount();++t){let i=n.getChildAt(t);if(i.kind===core_1.ts.SyntaxKind.PropertyAssignment){let t=i;if("computed"===t.name.getText()&&(null==t?void 0:t.initializer.kind)===core_1.ts.SyntaxKind.CallExpression){let n=t.initializer;if(n.expression.kind===core_1.ts.SyntaxKind.Identifier&&"mapState"===n.expression.escapedText){let t=n.arguments[0];if(!t)return e;e.push(...a(t))}}}}return e}function a(t){let e=[];if(!t)return e;if(t.kind===core_1.ts.SyntaxKind.ObjectLiteralExpression){t.forEachChild((t=>{if(t.kind===core_1.ts.SyntaxKind.PropertyAssignment){let n=t.name.getText();e.push(n)}}))}else if(t.kind===core_1.ts.SyntaxKind.ArrayLiteralExpression){t.forEachChild((t=>{if(t.kind===core_1.ts.SyntaxKind.StringLiteral){let n=t.text;e.push(n)}}))}return e}function l(t){let e=[];const{mapActions:n}=s(t);return n&&e.push(...a(n)),e}function u(t){let e=[];const{mapMutations:n}=s(t);return n&&e.push(...a(n)),e}t.getDefinitionSymbolAtLocation=i,t.getTypesAtLocation=function(t,e,n){if(!t||!t.parent)return[];let r=e.getProgram();if(null==r)return[];let s=r.getTypeChecker();switch(t.parent.kind){case core_1.ts.SyntaxKind.PropertyAccessExpression:{let e=null,n=t.parent.expression;if(n.kind===core_1.ts.SyntaxKind.PropertyAccessExpression){if(e=n.name,n.expression.kind===core_1.ts.SyntaxKind.PropertyAccessExpression){let t=i(e,s);for(let e=0;e<t.length;++e){if(!t[e])continue;const n=t[e].valueDeclaration;if(!n)continue;let i=s.getTypeOfSymbolAtLocation(t[e],n);if("Dictionary<string>"===s.typeToString(i))return["VueRouterParams"]}}}break}case core_1.ts.SyntaxKind.CallExpression:{let e=t.parent.expression;if((null==e?void 0:e.kind)===core_1.ts.SyntaxKind.ImportKeyword){return["HBuilderX.ImportURIString"]}if(core_1.ts.isIdentifier(e)&&"require"===e.getText())return["HBuilderX.ImportURIString","HBuilderX.RequireCommonString"];break}case core_1.ts.SyntaxKind.BinaryExpression:{let e=t.parent,n=s.getTypeAtLocation(e.left);if(n){return s.typeToString(n).split("|").map((t=>t.trim()))}break}case core_1.ts.SyntaxKind.ImportDeclaration:{let t=["HBuilderX.ImportURIString"];return n&&(n.endsWith(".vue.js")||n.endsWith(".vue.ts")||n.endsWith(".nvue.js")||n.endsWith(".nvue.ts")||n.endsWith(".uvue.js")||n.endsWith(".uvue.ts"))&&t.push("HBuilderX.VueFileURIString"),t}}let o=s.getContextualType(t,4);if(o){return s.typeToString(o).split("|").map((t=>t.trim()))}return[]},t.getVuexState=o,t.getVuexActions=l,t.getVuexMutations=u,t.getVuexInfo=function(t){return{state:o(t),actions:l(t),mutations:u(t)}}}(ParseUtil||(exports.ParseUtil=ParseUtil={}));