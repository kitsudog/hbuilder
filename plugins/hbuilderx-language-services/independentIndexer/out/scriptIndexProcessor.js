"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.createFileIndexProcessor=exports.ScriptIndexProcessor=void 0;const tsserverlibrary_1=__importDefault(require("typescript/lib/tsserverlibrary")),core_1=require("../../core"),vueComponentIndex_1=require("./handle/vueScript/vueComponentIndex"),vueDirectiveIndex_1=require("./handle/vueScript/vueDirectiveIndex"),vueFileRefIndex_1=require("./handle/vueScript/vueFileRefIndex"),vuePageJump_1=require("./handle/vueScript/vuePageJump"),vuexIndex_1=require("./handle/vueScript/vuexIndex");class ScriptIndexProcessor extends core_1.IndexProcessor{getProcessorID(){return"script"}isSupportIndexer(e,r){let t=!1;return"javascript"!==r.languageId&&"javascript_es6"!==r.languageId||(t=!0),r.uri.endsWith(".js")&&(t=!0),t}async createIndexData(e,r,t){const s=r.getText(),i=tsserverlibrary_1.default.createSourceFile("index.ts",s,tsserverlibrary_1.default.ScriptTarget.ESNext,!1,tsserverlibrary_1.default.ScriptKind.TS),n=[],u=[],a=[],c=[];let o=!1,d=!1,p=!1;tsserverlibrary_1.default.forEachChildRecursively(i,(function(e,r){o=(0,vuexIndex_1.hasVuexRef)(e,r,o),d=(0,vueComponentIndex_1.hasVueComponentIndexRef)(e,r,d),p=(0,vueDirectiveIndex_1.hasVueDirectiveIndexRef)(e,r,p)})),tsserverlibrary_1.default.forEachChildRecursively(i,(function(s,i){const l=(0,vueFileRefIndex_1.createRefFileRefData)(e,r,t,s,i);l&&n.push(...l);if(o){const e=(0,vuexIndex_1.createVuexData)(r,t,s,i);e&&u.push(...e)}if(d){const e=(0,vueComponentIndex_1.createVueComponentData)(r,t,s,i);e&&a.push(...e)}if(p){const e=(0,vueDirectiveIndex_1.createVueDirectiveData)(r,t,s,i);e&&c.push(...e)}const x=(0,vuePageJump_1.createVuePageJumpData)(e,r,t,s,i);x&&n.push(...x)}));const l=new Map;l.set("REF",n),l.set("VUEX",u),l.set("VUE_COMPONENT",a),l.set("VUE_DIRECTIVE",c);const x=(0,core_1.assemblyKindData)(l,e,r.uri);if(0!==x.kindMap.size)return x}}function createFileIndexProcessor(){return new ScriptIndexProcessor}exports.ScriptIndexProcessor=ScriptIndexProcessor,exports.createFileIndexProcessor=createFileIndexProcessor;