"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.UTSPluginAppJsPolicy=void 0;const hx=require("../../../../core"),types_1=require("../types"),utsLanguageServiceInterface_1=require("../utsLanguageServiceInterface"),uts_plugin_host_1=require("./uts_plugin_host"),uts_plugin_policy_1=require("./uts_plugin_policy");class UTSPluginAppJsHost extends uts_plugin_host_1.UTSPluginHost{getScriptFileNames(){const e=super.getScriptFileNames().filter((e=>!(!this._info.project.isProjectOf(e,hx.ts)||utsLanguageServiceInterface_1.Global.resolveUtsPluginPlatform(e,this._info.project)!==types_1.UtsPluginPlatform.APP_JS)));return e.push(utsLanguageServiceInterface_1.UtsPluginLanguageService.Constants.DCLOUD_IO_UNI_APP_X_BASE_LIB_PATH_PLUGIN_ENTRY_FILE_PATH,utsLanguageServiceInterface_1.UtsPluginLanguageService.Constants.SPECIAL_STRING_BASE_LIB_PATH,...utsLanguageServiceInterface_1.UtsPluginLanguageService.Utils.getPlatformDefaultLibs(types_1.UtsPluginPlatform.COMMON)),e}}class UTSPluginAppJsPolicy extends uts_plugin_policy_1.UTSPluginPolicy{constructor(e){super(),this._info=e}get kind(){return"uts_plugin_appp_js"}getLanguageServiceContextIfHasPolicy(e,t){let i=utsLanguageServiceInterface_1.Global.resolveUtsPluginPlatform(e,this._info.project);if(i&&i===types_1.UtsPluginPlatform.APP_JS)return this._realLs||(this._realLs=this.createLanguageService()),[{languageService:this._realLs,fileName:e,position:t,target:void 0}]}createLanguageService(){const e=new UTSPluginAppJsHost(this._info),t=this._info.ts.createLanguageService2(this._info,e,this._info.project.documentRegistry);return hx.ExtLanguageService.create(t)}}exports.UTSPluginAppJsPolicy=UTSPluginAppJsPolicy;