"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.WebLanguageService=exports.UTSPluginWebPolicy=void 0;const hx=require("../../../../core"),types_1=require("../types"),utsLanguageServiceInterface_1=require("../utsLanguageServiceInterface"),uts_plugin_policy_1=require("./uts_plugin_policy"),uts_plugin_host_1=require("./uts_plugin_host");class WebPluginHost extends uts_plugin_host_1.UTSPluginHost{getScriptFileNames(){const e=super.getScriptFileNames().filter((e=>!(!this._info.project.isProjectOf(e,hx.ts)||utsLanguageServiceInterface_1.Global.resolveUtsPluginPlatform(e,this._info.project)!==types_1.UtsPluginPlatform.WEB)));return e.push(utsLanguageServiceInterface_1.UtsPluginLanguageService.Constants.DCLOUD_IO_UNI_APP_X_BASE_LIB_PATH_PLUGIN_ENTRY_FILE_PATH,utsLanguageServiceInterface_1.UtsPluginLanguageService.Constants.SPECIAL_STRING_BASE_LIB_PATH,...utsLanguageServiceInterface_1.UtsPluginLanguageService.Utils.getPlatformDefaultLibs(types_1.UtsPluginPlatform.WEB),...utsLanguageServiceInterface_1.UtsPluginLanguageService.Utils.getPlatformDefaultLibs(types_1.UtsPluginPlatform.COMMON)),e}}class UTSPluginWebPolicy extends uts_plugin_policy_1.UTSPluginPolicy{constructor(e){super(),this._info=e}get kind(){return"uts_plugin_web"}getLanguageServiceContextIfHasPolicy(e,t){let i=utsLanguageServiceInterface_1.Global.resolveUtsPluginPlatform(e,this._info.project);if(i&&i===types_1.UtsPluginPlatform.WEB)return this._realLs||(this._realLs=this.createLanguageService()),[{languageService:this._realLs,fileName:e,position:t,target:void 0}]}createLanguageService(){const e=new WebPluginHost(this._info),t=this._info.ts.createLanguageService2(this._info,e,this._info.project.documentRegistry);return hx.ExtLanguageService.create(t)}}exports.UTSPluginWebPolicy=UTSPluginWebPolicy;class WebLanguageService{constructor(e){this._ls=void 0,this._info=e}async getCompletionsAtPosition(e,t,i){return this.getUtsLanguageService().getCompletionsAtPosition(e,t,i)}getCompletionEntryDetails(e,t,i,n,g,s,r){return this.getUtsLanguageService().getCompletionEntryDetails(e,t,i,n,g,s,r)}async getDefinitionAndBoundSpan(e,t){return this.getUtsLanguageService().getDefinitionAndBoundSpan(e,t)}async getQuickInfoAtPosition(e,t){return this.getUtsLanguageService().getQuickInfoAtPosition(e,t)}async getSemanticDiagnosticsAsync(e){let t=this.getUtsLanguageService(),i=t.getSemanticDiagnostics(e);return utsLanguageServiceInterface_1.UtsPluginLanguageService.CommonLogic.getSemanticDiagnostics(t,e,this._info.ts,i)}getSignatureHelpItems(e,t,i){return this.getUtsLanguageService().getSignatureHelpItems(e,t,i)}getCodeFixesAtPosition(e,t,i,n,g,s){return this.getUtsLanguageService().getCodeFixesAtPosition(e,t,i,n,g,s)}async getSuggestionDiagnosticsAsync(e){return this.getUtsLanguageService().getSuggestionDiagnostics(e)}async getSyntacticDiagnosticsAsync(e){const t=this.getUtsLanguageService();let i=t.getSyntacticDiagnostics(e);return utsLanguageServiceInterface_1.UtsPluginLanguageService.CommonLogic.getSyntacticDiagnostics(t,e,this._info.ts,i,this._info.target)}getCompletionEntrySymbol(e,t,i,n){return this.getUtsLanguageService().getCompletionEntrySymbol(e,t,i,n)}getDefinitionAtPosition(e,t){return this.getUtsLanguageService().getDefinitionAtPosition(e,t)}getTypeDefinitionAtPosition(e,t){return this.getUtsLanguageService().getTypeDefinitionAtPosition(e,t)}getImplementationAtPosition(e,t){return this.getUtsLanguageService().getImplementationAtPosition(e,t)}getDocumentHighlights(e,t,i){return this.getUtsLanguageService().getDocumentHighlights(e,t,i)}findRenameLocations(e,t,i,n,g){return this.getUtsLanguageService().findRenameLocations(e,t,i,n,g)}getReferencesAtPosition(e,t){return this.getUtsLanguageService().getReferencesAtPosition(e,t)}findReferences(e,t){return this.getUtsLanguageService().findReferences(e,t)}getNavigateToItems(e,t,i,n){return this.getUtsLanguageService().getNavigateToItems(e,t,i,n)}getEmitOutput(e,t,i){return this.getUtsLanguageService().getEmitOutput(e,t,i)}getSemanticClassifications(e,t,i){return this.getUtsLanguageService().getSemanticClassifications(e,t,i)}getEncodedSemanticClassifications(e,t,i){return this.getUtsLanguageService().getEncodedSemanticClassifications(e,t,i)}getCombinedCodeFix(e,t,i,n){return this.getUtsLanguageService().getCombinedCodeFix(e,t,i,n)}organizeImports(e,t,i){return this.getUtsLanguageService().organizeImports(e,t,i)}getTodoComments(e,t){return this.getUtsLanguageService().getTodoComments(e,t)}getRenameInfo(e,t,i){return this.getUtsLanguageService().getRenameInfo(e,t,i)}getApplicableRefactors(e,t,i,n,g){return this.getUtsLanguageService().getApplicableRefactors(e,t,i,n,g)}getEditsForRefactor(e,t,i,n,g,s){return this.getUtsLanguageService().getEditsForRefactor(e,t,i,n,g,s)}prepareCallHierarchy(e,t){return this.getUtsLanguageService().prepareCallHierarchy(e,t)}provideCallHierarchyIncomingCalls(e,t){return this.getUtsLanguageService().provideCallHierarchyIncomingCalls(e,t)}provideCallHierarchyOutgoingCalls(e,t){return this.getUtsLanguageService().provideCallHierarchyOutgoingCalls(e,t)}provideInlayHints(e,t,i){return this.getUtsLanguageService().provideInlayHints(e,t,i)}getFileReferences(e){return this.getUtsLanguageService().getFileReferences(e)}getUtsLanguageService(){if(!this._ls){const e=new WebPluginHost(this._info);this._ls=this._info.ts.createLanguageService2(this._info,e,this._info.project.documentRegistry)}return this._ls}}exports.WebLanguageService=WebLanguageService;