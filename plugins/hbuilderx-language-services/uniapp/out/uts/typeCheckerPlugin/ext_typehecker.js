"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ExtTypeCheckerPlugin=void 0;const core_1=require("../../../../core"),utsLanguageServiceInterface_1=require("../utsLanguageServiceInterface");class ExtTypeCheckerPlugin{constructor(e){this.info=e,this.extApi=utsLanguageServiceInterface_1.UtsPluginLanguageService.Utils.getExtApi(this.info)}checkExpression(e,s,t,r,i,a){if(r.kind===core_1.ts.SyntaxKind.Identifier&&"uni"===r.getText()&&this.extApi){let e=t.defaultCheckExpression(r,i),s=this.extApi.getExportFiles(),a=e,o=t.createAnonymousResolvedType(a.symbol,a.members,a.callSignatures,a.constructSignatures,a.indexInfos);return s.forEach((e=>{var s;const r=null===(s=this.info.languageService.getProgram())||void 0===s?void 0:s.getSourceFile(e);if(r){let e=t.getSymbolsInScope(r,core_1.ts.SymbolFlags.Interface).find((e=>"Uni"===e.escapedName));if(e){let s=e.members;s&&o.symbol.members&&s.forEach((e=>{var s,t;e.escapedName&&(null===(s=this.extApi)||void 0===s?void 0:s.hasExtApi(e.escapedName))&&(null===(t=o.symbol.members)||void 0===t||t.delete(e.escapedName),o.symbol.members&&e.escapedName&&o.symbol.members.set(e.escapedName,e),o&&o.members&&o.properties&&(o.properties.forEach(((s,t)=>{s.escapedName===e.escapedName&&o.properties.splice(t,1)})),o.members.set(e.escapedName,e),o.properties.push(e)))}))}}})),o}}}exports.ExtTypeCheckerPlugin=ExtTypeCheckerPlugin;