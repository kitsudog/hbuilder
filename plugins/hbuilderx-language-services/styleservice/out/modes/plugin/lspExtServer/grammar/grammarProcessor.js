"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getGrammarCompletionData=void 0;const vscode_languageserver_protocol_1=require("vscode-languageserver-protocol"),vscode_uri_1=require("vscode-uri"),core_1=require("../../../../../../core"),node_1=require("../../../../../../htmlservice/entry/out/node"),serviceTypes_1=require("../../../../serviceTypes"),util_1=require("../utils/util");function getGrammarCompletionData(e,t,o,r,s){if(!(0,util_1.styleIsRightCompletionType)(r,void 0,[serviceTypes_1.NodeType.ClassSelector,serviceTypes_1.NodeType.IdentifierSelector,serviceTypes_1.NodeType.ElementNameSelector],serviceTypes_1.NodeType.Selector))return s;let i=s.items;for(var a=i.length-1;a>=0;--a){Object.keys(serviceTypes_1.html5Tags).includes(i[a].label)&&i.splice(a,1)}let l=(0,node_1.getHtmlTags)(e);for(a=i.length-1;a>=0;--a)l.includes(i[a].label)&&i.splice(a,1);let n=t.offsetAt(o),c=(0,core_1.getContextData)(t,n,void 0).leftText,d=vscode_languageserver_protocol_1.Position.create(o.line,o.character-c.length);for(let e of l)e.length>0&&i.push({label:e,textEdit:vscode_languageserver_protocol_1.TextEdit.replace(vscode_languageserver_protocol_1.Range.create(d,o),e),kind:vscode_languageserver_protocol_1.CompletionItemKind.Keyword,data:{hxKind:core_1.HxIconKind.ELEMENT}});if(!e)return console.error("getGrammarCompletionData.workspaceFolder is undefined"),s;let _=vscode_uri_1.URI.parse(t.uri).fsPath,p=vscode_uri_1.URI.parse(e.uri).fsPath;const u=(0,core_1.detectProjectKind)(p),v=u!==core_1.HXProjectKind.UniApp&&u!==core_1.HXProjectKind.UniApp_Cli,g=_.endsWith(".nvue")||_.endsWith(".uvue")||_.endsWith(".vue")||_.endsWith(".css")||_.endsWith(".scss")||_.endsWith(".less")||_.endsWith(".styl");return v&&g&&i.push({label:"page",textEdit:vscode_languageserver_protocol_1.TextEdit.replace(vscode_languageserver_protocol_1.Range.create(d,o),"page"),documentation:{kind:"markdown",value:"Equivalent to the body node"},kind:vscode_languageserver_protocol_1.CompletionItemKind.Keyword,data:{hxKind:core_1.HxIconKind.ELEMENT}}),s}exports.getGrammarCompletionData=getGrammarCompletionData;