"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getNearestVar=void 0;const ts=require("typescript");function getNearestVarNode(t,e){let s=null,i=null;return t.forEach((t=>{const r=t.pos;if(r<=e&&(null===s||Math.abs(r-e)<Math.abs(s-e))){if((ts.isFunctionExpression(t)||ts.isArrowFunction(t)||ts.isMethodDeclaration(t)||ts.isFunctionDeclaration(t))&&0===t.parameters.length)return i;s=r,i=t}})),i}function getNearestVar(t){const e=t.window.activeTextEditor,s=null==e?void 0:e.document,i=null==s?void 0:s.getText(),r=e.selection.active,n=s.offsetAt(r),a=ts.createSourceFile("",i,ts.ScriptTarget.Latest),o=[];if(a&&ts.isSourceFile(a)){a.forEachChild((function t(e){(ts.isFunctionExpression(e)||ts.isArrowFunction(e)||ts.isFunctionDeclaration(e)||ts.isMethodDeclaration(e)||ts.isTryStatement(e)||ts.isIfStatement(e))&&(e.pos<n&&e.end>=n&&o.push(e),e.end<=n)||(ts.isVariableDeclaration(e)&&o.push(e),ts.forEachChild(e,t))}));const t=getNearestVarNode(o,n);if(!t)return"";if(ts.isVariableDeclaration(t)&&ts.isIdentifier(t.name))return t.name.escapedText;if(ts.isFunctionExpression(t)||ts.isArrowFunction(t)||ts.isFunctionLike(t)||ts.isFunctionDeclaration(t)){const e=t.parameters.length-1,s=t.parameters[e].name;if(ts.isIdentifier(s))return s.escapedText}}return""}exports.getNearestVar=getNearestVar;