"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,o)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding(t,e,r);return __setModuleDefault(t,e),t};Object.defineProperty(exports,"__esModule",{value:!0}),exports.getVeturDataProviders=exports.VeturDataProvider=void 0;const fs=__importStar(require("fs")),path=__importStar(require("path")),vscode_uri_1=require("vscode-uri"),utils_1=require("../../../utils"),nuxtDataProvider_1=require("./nuxtDataProvider"),veturProviderParse_1=require("./veturProviderParse"),core_1=require("../../../core");var veturProviderParse_2=require("./veturProviderParse");function getVeturDataProviders(e){const t=vscode_uri_1.URI.parse(e).fsPath;let r=[];const i=utils_1.hx.createProject(t).kind===utils_1.hx.HXProjectKind.UniApp;let o=path.join(t,"package.json");if(fs.existsSync(o))try{const e=JSON.parse(fs.readFileSync(o,"utf-8")),n=e.dependencies||{},u=e.devDependencies||{};if((n["nuxt-buefy"]||u["nuxt-buefy"])&&(n.buefy=!0),(n["@nuxtjs/vuetify"]||u["@nuxtjs/vuetify"])&&(n.vuetify=!0),(n["element-ui"]||u["element-ui"])&&r.push(veturProviderParse_1.elementTagProvider.clone()),(n["vue-onsenui"]||u["vue-onsenui"])&&r.push(veturProviderParse_1.onsenTagProvider.clone()),n.gridsome&&r.push(veturProviderParse_1.gridsomeTagProvider.clone()),u["quasar-cli"]&&(n["quasar-framework"]="^0.0.17"),n.nuxt||n["nuxt-edge"]||u.nuxt||u["nuxt-edge"]){const e=(0,nuxtDataProvider_1.getNuxtDataProvider)(t);e&&r.push(e)}const s=(0,veturProviderParse_1.getWorkspaceDataProvider)(t,e);s&&r.push(s);let a=new Set;for(const e of[...Object.keys(n),...Object.keys(u)]){let i;try{i=require.resolve(path.join(e,"package.json"),{paths:[t]})}catch{continue}const o=JSON.parse(fs.readFileSync(i,"utf-8"));if(o){const i=(0,veturProviderParse_1.getDependencyDataProvider)(t,e,o);i&&(a.add(e),r.push(i))}}if(!a.has("vue-router")){let e=path.join(utils_1.hx.getExtensionRootPath(),"builtin-dts/uniapp@vue2/node_modules/vue-router");i&&3===(0,core_1.vueVersionFroProjectPath)(t)&&(e=path.join(utils_1.hx.getExtensionRootPath(),"builtin-dts/uniapp@vue3/node_modules/vue-router"));const o=path.join(e,"package.json");if(fs.existsSync(o)){const t=JSON.parse(fs.readFileSync(o,"utf-8"));if(t){const i=(0,veturProviderParse_1.getDependencyDataProvider)(e,"vue-router",t);i&&r.push(i)}}}if(!a.has("vue-i18n")&&i){let e=path.join(utils_1.hx.getExtensionRootPath(),"builtin-dts/uniapp@vue2/node_modules/vue-i18n");i&&3===(0,core_1.vueVersionFroProjectPath)(t)&&(e=path.join(utils_1.hx.getExtensionRootPath(),"builtin-dts/uniapp@vue3/node_modules/vue-i18n"));const o=path.join(e,"package.json");if(fs.existsSync(o)){const t=JSON.parse(fs.readFileSync(o,"utf-8"));if(t){const i=(0,veturProviderParse_1.getDependencyDataProvider)(e,"vue-i18n",t);i&&r.push(i)}}}}catch(e){console.error(e.stack)}try{let e=utils_1.hx.createProject(t);if(e&&e.kind==utils_1.hx.HXProjectKind.UniApp){let e={"vue-router":path.join(utils_1.hx.getExtensionRootPath(),`builtin-dts/uniapp@vue${3===(0,core_1.vueVersionFroProjectPath)(t)?"3":"2"}/node_modules/vue-router`),"vue-i18n":path.join(utils_1.hx.getExtensionRootPath(),`builtin-dts/uniapp@vue${3===(0,core_1.vueVersionFroProjectPath)(t)?"3":"2"}/node_modules/vue-i18n`)};for(const t in e){if(!r.find((e=>e.getId()==t))){let i=e[t];const o=path.join(i,"package.json");if(fs.existsSync(o)){const e=JSON.parse(fs.readFileSync(o,"utf-8"));if(e){const o=(0,veturProviderParse_1.getDependencyDataProvider)(i,t,e);o&&r.push(o)}}}}}}catch(e){}return r}Object.defineProperty(exports,"VeturDataProvider",{enumerable:!0,get:function(){return veturProviderParse_2.VeturDataProvider}}),exports.getVeturDataProviders=getVeturDataProviders;