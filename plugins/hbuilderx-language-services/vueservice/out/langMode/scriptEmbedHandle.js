"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.VueScriptEmbedHandler=void 0;const core_1=require("../../../core");class VueScriptEmbedHandler{constructor(e,t){this.info=e,this.vueCachesInProjectScope=t}doExtraCompletion(e,t,r,o,i){return e=this.addGlobalPropertyData(e,t,r,o,i)}addGlobalPropertyData(e,t,r,o,i){if(!e)return e;const s=this.vueCachesInProjectScope.getEmbeddedFile(r);if(!s)return e;const n=s.file;if(!n)return e;if(!n.isTsHostFile)return e;const c=e,a=t.getProgram();if(!a)return e;const l=a.getSourceFile(n.fileName);if(!l)return e;const u=this.info.ts.getTokenAtPosition(l,o-1),p=this.info.ts.getTouchingPropertyName(l,o-1);if(!this.info.ts.isPropertyAccessExpression(u.parent))return e;const d=u.parent.expression;if(!d||!this.info.ts.isIdentifier(d))return e;if("__VLS_ctx"!==d.getText(l))return e;const f=a.getTypeChecker(),m=f.getSymbolsInScope(u,core_1.ts.SymbolFlags.Variable);return m&&m.forEach((e=>{c.entries.push({name:e.getName(),kind:this.info.ts.SymbolDisplay.getSymbolKind(f,e,p),sortText:e.getName(),source:"vls_completion"})})),c}}exports.VueScriptEmbedHandler=VueScriptEmbedHandler;