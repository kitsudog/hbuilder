"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(e,n,o,i){void 0===i&&(i=o);var s=Object.getOwnPropertyDescriptor(n,o);s&&!("get"in s?!n.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return n[o]}}),Object.defineProperty(e,i,s)}:function(e,n,o,i){void 0===i&&(i=o),e[i]=n[o]}),__exportStar=this&&this.__exportStar||function(e,n){for(var o in e)"default"===o||Object.prototype.hasOwnProperty.call(n,o)||__createBinding(n,e,o)};Object.defineProperty(exports,"__esModule",{value:!0}),exports.getLanguageService=void 0;const jsonCompletion_1=require("./services/jsonCompletion"),jsonHover_1=require("./services/jsonHover"),jsonValidation_1=require("./services/jsonValidation"),jsonParser_1=require("./parser/jsonParser"),configuration_1=require("./services/configuration"),jsonDocumentSymbols_1=require("./services/jsonDocumentSymbols"),jsonFolding_1=require("./services/jsonFolding"),jsonSchemaService_1=require("./services/jsonSchemaService"),jsonSelectionRanges_1=require("./services/jsonSelectionRanges"),jsonc_parser_1=require("jsonc-parser"),jsonLanguageTypes_1=require("./jsonLanguageTypes"),jsonLinks_1=require("./services/jsonLinks");function getLanguageService(e){const n=e.promiseConstructor||Promise,o=new jsonSchemaService_1.JSONSchemaService(e.schemaRequestService,e.workspaceContext,n);o.setSchemaContributions(configuration_1.schemaContributions);const i=new jsonCompletion_1.JSONCompletion(o,e.contributions,n,e.clientCapabilities),s=new jsonHover_1.JSONHover(o,e.contributions,n),t=new jsonDocumentSymbols_1.JSONDocumentSymbols(o),r=new jsonValidation_1.JSONValidation(o,n);return{configure:e=>{o.clearExternalSchemas(),e.schemas&&e.schemas.forEach((e=>{o.registerExternalSchema(e.uri,e.fileMatch,e.schema)})),r.configure(e)},resetSchema:e=>o.onResourceChange(e),doValidation:r.doValidation.bind(r),parseJSONDocument:e=>(0,jsonParser_1.parse)(e,{collectComments:!0}),newJSONDocument:(e,n)=>(0,jsonParser_1.newJSONDocument)(e,n),getMatchingSchemas:o.getMatchingSchemas.bind(o),doResolve:i.doResolve.bind(i),doComplete:i.doComplete.bind(i),findDocumentSymbols:t.findDocumentSymbols.bind(t),findDocumentSymbols2:t.findDocumentSymbols2.bind(t),findDocumentColors:t.findDocumentColors.bind(t),getColorPresentations:t.getColorPresentations.bind(t),doHover:s.doHover.bind(s),getFoldingRanges:jsonFolding_1.getFoldingRanges,getSelectionRanges:jsonSelectionRanges_1.getSelectionRanges,findDefinition:()=>Promise.resolve([]),findLinks:jsonLinks_1.findLinks,format:(e,n,o)=>{let i;if(n){const o=e.offsetAt(n.start);i={offset:o,length:e.offsetAt(n.end)-o}}const s={tabSize:o?o.tabSize:4,insertSpaces:!0===(null==o?void 0:o.insertSpaces),insertFinalNewline:!0===(null==o?void 0:o.insertFinalNewline),eol:"\n"};return(0,jsonc_parser_1.format)(e.getText(),i,s).map((n=>jsonLanguageTypes_1.TextEdit.replace(jsonLanguageTypes_1.Range.create(e.positionAt(n.offset),e.positionAt(n.offset+n.length)),n.content)))}}}__exportStar(require("./jsonLanguageTypes"),exports),exports.getLanguageService=getLanguageService;