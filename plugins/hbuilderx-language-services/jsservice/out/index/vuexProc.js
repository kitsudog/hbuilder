"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getVuexIndexProc=void 0;const core_1=require("./../../../core"),utils_1=require("./utils");function getVuexIndexProc(e){let t=new Set;return{support:(e,t)=>e.getText().indexOf("vuex")>0,onImportDeclaration(e,o){var n,r,s;if("vuex"===(0,utils_1.removeQuot)(o.moduleSpecifier.getText())){let e=null!==(s=null===(r=null===(n=o.importClause)||void 0===n?void 0:n.name)||void 0===r?void 0:r.getText())&&void 0!==s?s:"";e&&t.add(e)}return null},onNewExpression(e,o,n,r){var s,l;if(!n||!o.arguments||0===o.arguments.length)return null;let i=n.getText();if(i.endsWith(".Store")&&t.has(i.slice(0,-6))){let t=o.arguments[0],n=null!==(l=null===(s=utils_1.tsConvert.asTsObjectLiteralExpression(t))||void 0===s?void 0:s.properties)&&void 0!==l?l:[],i=[],u=[],a=[];for(let t=0;t<n.length;t++){let o=utils_1.tsConvert.asTsPropertyAssignment(n[t]);if(o){const t=o.name.getText();let n;if(/^['\"]?state['\"]?$/.test(t)?n=i:/^['\"]?mutations['\"]?$/.test(t)?n=u:/^['\"]?actions['\"]?$/.test(t)&&(n=a),n){let t=utils_1.tsConvert.asTsObjectLiteralExpression(o.initializer);null==t||t.properties.forEach((t=>{var o,s;let l=null!==(s=null===(o=t.name)||void 0===o?void 0:o.getText())&&void 0!==s?s:"";if(l){let o=(0,utils_1.removeQuot)(l),s=t.getStart();o.length!=l.length&&s++,l=o;let i=e.positionAt(s);r&&r.source&&(s=r.source.offsetAt(i)),n.push({name:l,position:i,offset:s})}}))}}}if(i.length>0||u.length>0||a.length>0){let e={label:"construct-args"};e.data={state:i.length>0?i:void 0,mutations:u.length>0?u:void 0,actions:a.length>0?a:void 0};let t=new core_1.IndexData;return t.categories.push("vuex-construct"),t["vuex-construct"]=[e],t}}return null}}}exports.getVuexIndexProc=getVuexIndexProc;