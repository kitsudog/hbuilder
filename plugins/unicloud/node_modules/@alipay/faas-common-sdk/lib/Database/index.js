"use strict";var __assign=this&&this.__assign||function(){__assign=Object.assign||function(i){for(var a,n=1,o=arguments.length;n<o;n++){a=arguments[n];for(var r in a)if(Object.prototype.hasOwnProperty.call(a,r))i[r]=a[r]}return i};return __assign.apply(this,arguments)};var __awaiter=this&&this.__awaiter||function(i,a,n,o){function r(t){return t instanceof n?t:new n(function(u){u(t)})}return new(n||(n=Promise))(function(t,u){function c(s){try{e(o.next(s))}catch(f){u(f)}}function l(s){try{e(o["throw"](s))}catch(f){u(f)}}function e(s){s.done?t(s.value):r(s.value).then(c,l)}e((o=o.apply(i,a||[])).next())})};var __generator=this&&this.__generator||function(i,a){var n={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},o,r,t,u;return u={next:c(0),"throw":c(1),"return":c(2)},typeof Symbol==="function"&&(u[Symbol.iterator]=function(){return this}),u;function c(e){return function(s){return l([e,s])}}function l(e){if(o)throw new TypeError("Generator is already executing.");while(u&&(u=0,e[0]&&(n=0)),n)try{if(o=1,r&&(t=e[0]&2?r["return"]:e[0]?r["throw"]||((t=r["return"])&&t.call(r),0):r.next)&&!(t=t.call(r,e[1])).done)return t;if(r=0,t)e=[e[0]&2,t.value];switch(e[0]){case 0:case 1:t=e;break;case 4:n.label++;return{value:e[1],done:false};case 5:n.label++;r=e[1];e=[0];continue;case 7:e=n.ops.pop();n.trys.pop();continue;default:if(!(t=n.trys,t=t.length>0&&t[t.length-1])&&(e[0]===6||e[0]===2)){n=0;continue}if(e[0]===3&&(!t||e[1]>t[0]&&e[1]<t[3])){n.label=e[1];break}if(e[0]===6&&n.label<t[1]){n.label=t[1];t=e;break}if(t&&n.label<t[2]){n.label=t[2];n.ops.push(e);break}if(t[2])n.ops.pop();n.trys.pop();continue}e=a.call(i,n)}catch(s){e=[6,s];r=0}finally{o=t=0}if(e[0]&5)throw e[1];return{value:e[0]?e[1]:void 0,done:true}}};Object.defineProperty(exports,"__esModule",{value:true});exports.Database=void 0;var faas_db_builder_1=require("@alipay/faas-db-builder");var error_1=require("../error");var Collection_1=require("./Collection");var DatabaseHttpclient=function(){function i(a){this.httpclient=a}i.prototype.request=function(a){return __awaiter(this,arguments,void 0,function(n){var o=n.method,r=n.path,t=n.data,u=n.headers;return __generator(this,function(c){switch(c.label){case 0:return[4,this.httpclient.request({method:o,path:r,data:t,headers:__assign({"x-alipay-cloud-mode":"mongo","x-data-api-type":"mongo","x-expire-timestamp":"".concat(Date.now()+6e4)},u)})];case 1:return[2,c.sent()]}})})};return i}();var Database=function(){function i(a){this.command=new faas_db_builder_1.Command;this.options=__assign(__assign({},a),{httpclient:new DatabaseHttpclient(a.httpclient)})}i.prototype.collection=function(a){if(!a){throw error_1.FaasError.INVALID_PARAM_ERR("collectionName","\u4E0D\u80FD\u4E3A\u7A7A")}return new Collection_1.Collection(a,this.options)};return i}();exports.Database=Database;