var h=function(){h=Object.assign||function(o){for(var s,n=1,a=arguments.length;n<a;n++){s=arguments[n];for(var r in s)if(Object.prototype.hasOwnProperty.call(s,r))o[r]=s[r]}return o};return h.apply(this,arguments)};var y=function(o,s,n,a){function r(e){return e instanceof n?e:new n(function(c){c(e)})}return new(n||(n=Promise))(function(e,c){function u(i){try{t(a.next(i))}catch(f){c(f)}}function l(i){try{t(a["throw"](i))}catch(f){c(f)}}function t(i){i.done?e(i.value):r(i.value).then(u,l)}t((a=a.apply(o,s||[])).next())})};var v=function(o,s){var n={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},a,r,e,c;return c={next:u(0),"throw":u(1),"return":u(2)},typeof Symbol==="function"&&(c[Symbol.iterator]=function(){return this}),c;function u(t){return function(i){return l([t,i])}}function l(t){if(a)throw new TypeError("Generator is already executing.");while(c&&(c=0,t[0]&&(n=0)),n)try{if(a=1,r&&(e=t[0]&2?r["return"]:t[0]?r["throw"]||((e=r["return"])&&e.call(r),0):r.next)&&!(e=e.call(r,t[1])).done)return e;if(r=0,e)t=[t[0]&2,e.value];switch(t[0]){case 0:case 1:e=t;break;case 4:n.label++;return{value:t[1],done:false};case 5:n.label++;r=t[1];t=[0];continue;case 7:t=n.ops.pop();n.trys.pop();continue;default:if(!(e=n.trys,e=e.length>0&&e[e.length-1])&&(t[0]===6||t[0]===2)){n=0;continue}if(t[0]===3&&(!e||t[1]>e[0]&&t[1]<e[3])){n.label=t[1];break}if(t[0]===6&&n.label<e[1]){n.label=e[1];e=t;break}if(e&&n.label<e[2]){n.label=e[2];n.ops.push(t);break}if(e[2])n.ops.pop();n.trys.pop();continue}t=s.call(o,n)}catch(i){t=[6,i];r=0}finally{a=e=0}if(t[0]&5)throw t[1];return{value:t[0]?t[1]:void 0,done:true}}};import{FaasError as d}from"./error";import{wrapCallback as b}from"./utils";export var createCallFunction=function(o){var s=o.httpclient;var n=function(a){return y(void 0,void 0,void 0,function(){var r,e,c,u,l,t,i;return v(this,function(f){switch(f.label){case 0:if(!a.name){throw d.INVALID_PARAM_ERR("name","\u7F3A\u5931")}r=h(h({},a.headers),{"x-to-function-name":a.name,"x-alipay-cloud-mode":"function"});if(a.async){r["x-function-invoke-type"]="async"}e="POST";c="/functions/invokeFunction";return[4,s.request({method:e,path:c,data:a.data,headers:r,responseDataType:a.resultDataType,timeout:a.timeout})];case 1:u=f.sent();if(u.status!==200){l=-1;t="";i=u.data;if(i){l=i.errCode,t=i.errMsg;if(i.errDetail){t+="\uFF0C\u8BE6\u60C5\uFF1A".concat(i.errDetail)}}throw d.SERVER_ERR(l,t,u.requestID,u.status)}return[2,{requestID:u.requestID,result:u.data,headers:u.headers}]}})})};return b(n)};