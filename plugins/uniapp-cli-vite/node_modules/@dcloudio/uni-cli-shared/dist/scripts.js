"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.parseScripts = void 0;
const fs_1 = __importDefault(require("fs"));
function parseScripts(name, pkgPath) {
    var _a, _b, _c;
    if (!fs_1.default.existsSync(pkgPath)) {
        return;
    }
    const pkg = JSON.parse(fs_1.default.readFileSync(pkgPath, 'utf8'));
    const options = (_b = (_a = pkg['uni-app']) === null || _a === void 0 ? void 0 : _a.scripts) === null || _b === void 0 ? void 0 : _b[name];
    if (!options) {
        return;
    }
    if (!((_c = options.env) === null || _c === void 0 ? void 0 : _c.UNI_PLATFORM)) {
        console.error(`package.json->uni-app->scripts->${name}->env->UNI_PLATFORM is required`);
        process.exit(0);
    }
    const { UNI_PLATFORM, ...define } = options.env;
    return {
        name: name,
        platform: UNI_PLATFORM,
        define,
        context: options.define || {},
    };
}
exports.parseScripts = parseScripts;
